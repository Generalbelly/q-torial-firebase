rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    function authData() {
      return request.auth;
    }
    function existingData() {
      return resource.data;
    }
    function incomingData() {
      return request.resource.data;
    }
    function signedIn() {
    	return authData().uid != null;
    }
    match /users/{userID}/tutorials/{tutorialID}/{document=**} {
      allow list, get, delete: if signedIn();
      allow create: if signedIn() &&
        incomingData().createdAt is timestamp &&
        incomingData().updatedAt is timestamp;
      allow update: if signedIn() &&
        incomingData().updatedAt is timestamp;
    }
    match /users/{userID}/oauths/{oauthID}/{document=**} {
      allow list, get, delete: if signedIn();
      allow create: if signedIn() &&
        incomingData().createdAt is timestamp &&
        incomingData().updatedAt is timestamp;
    }
  }
}